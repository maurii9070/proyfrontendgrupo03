<div class="d-flex justify-content-center align-items-center min-vh-100 bg-primary-subtle">
    <div class="card shadow-lg border-0 rounded-4" style="max-width: 400px; width: 100%">
        <div class="card-body p-5">
            <!-- Logo o título -->
            <div class="text-center mb-4">
                <h3 class="fw-bold text-primary mb-2">Resetear Contraseña</h3>
                <p class="text-muted">Defina una nueva contraseña</p>
            </div>

            <!-- Formulario de resetear password -->
            <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
                <!-- Campo Nueva Contraseña -->
                <div class="mb-3">
                    <label for="newPassword" class="form-label fw-medium text-dark">Nueva Contraseña</label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="bi bi-lock text-secondary"></i>
                        </span>
                        <input [type]="showPassword ? 'text' : 'password'"
                            class="form-control border-start-0 border-end-0 ps-2" id="newPassword"
                            formControlName="newPassword" placeholder="Ingrese su nueva contraseña"
                            [class.is-invalid]="newPassword?.invalid && newPassword?.touched"
                            [class.is-valid]="newPassword?.valid && newPassword?.touched" />
                        <span class="input-group-text bg-light border-start-0" style="cursor: pointer"
                            (click)="togglePasswordVisibility()">
                            <i [class]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'" class="text-secondary"></i>
                        </span>
                    </div>
                    <div class="form-text">Mínimo 6 caracteres</div>
                    <!-- Mensajes de validación para nueva contraseña -->
                    @if (newPassword?.invalid && newPassword?.touched) {
                    <div class="text-danger small mt-1">
                        @if (newPassword?.errors?.['required']) {
                        <div>
                            <i class="bi bi-exclamation-circle me-1"></i>La contraseña es
                            requerida
                        </div>
                        } @if (newPassword?.errors?.['minlength']) {
                        <div>
                            <i class="bi bi-exclamation-circle me-1"></i>La contraseña debe
                            tener al menos 6 caracteres
                        </div>
                        }
                    </div>
                    }
                </div>

                <!-- Campo Repetir Nueva Contraseña -->
                <div class="mb-4">
                    <label for="repeatPassword" class="form-label fw-medium text-dark">Repetir Nueva Contraseña</label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="bi bi-lock-fill text-secondary"></i>
                        </span>
                        <input [type]="showRepeatPassword ? 'text' : 'password'"
                            class="form-control border-start-0 border-end-0 ps-2" id="repeatPassword"
                            formControlName="repeatPassword" placeholder="Repita su nueva contraseña"
                            [class.is-invalid]="
  (repeatPassword?.invalid && repeatPassword?.touched) ||
  (resetPasswordForm.errors?.['passwordMismatch'] && !repeatPassword?.errors?.['required'] && (repeatPassword?.touched || submitted))
" [class.is-valid]="
                repeatPassword?.valid && repeatPassword?.touched
              " />
                        <span class="input-group-text bg-light border-start-0" style="cursor: pointer"
                            (click)="toggleRepeatPasswordVisibility()">
                            <i [class]="showRepeatPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"
                                class="text-secondary"></i>
                        </span>
                    </div>
                    <!-- Mensajes de validación para repetir contraseña -->
                    @if (repeatPassword?.errors?.['required'] && (repeatPassword?.touched
                    || submitted)) {
                    <div class="text-danger small mt-1">
                        <div>
                            <i class="bi bi-exclamation-circle me-1"></i>Debe repetir la
                            contraseña
                        </div>
                    </div>
                    } @if (resetPasswordForm.errors?.['passwordMismatch'] &&
                    !repeatPassword?.errors?.['required'] && (repeatPassword?.touched ||
                    submitted)) {
                    <div class="text-danger small mt-1">
                        <div>
                            <i class="bi bi-exclamation-circle me-1"></i>Las contraseñas no
                            coinciden
                        </div>
                    </div>
                    }
                </div>

                <!-- Botón de resetear -->
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg rounded-3"
                        [disabled]="resetPasswordForm.invalid || isLoading">
                        @if (isLoading) {
                        <span class="spinner-border spinner-border-sm me-2" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </span>
                        Procesando... } @else {
                        <i class="bi bi-shield-lock me-2"></i>
                        Resetear Contraseña }
                    </button>
                </div>
            </form>

            <!-- Link para volver atrás -->
            <div class="text-center mt-3">
                <button type="button" (click)="goBack()" class="btn btn-link text-decoration-none text-muted small p-0">
                    <i class="bi bi-arrow-left me-1"></i>
                    Volver
                </button>
            </div>
        </div>
    </div>
</div>